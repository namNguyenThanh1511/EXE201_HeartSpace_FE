# ğŸ§‘â€ğŸ’» Coding Convention â€” Heart Space (Next.js + React Query)

TÃ i liá»‡u nÃ y tÃ³m táº¯t quy Æ°á»›c mÃ£ nguá»“n Ä‘ang dÃ¹ng trong repository vÃ  Ä‘á»“ng bá»™ vá»›i cÃ¡c cáº¥u hÃ¬nh hiá»‡n cÃ³ (tsconfig, eslint, package.json).

## ğŸ“¦ Ká»¹ thuáº­t chÃ­nh

- Next.js 15.5.3
- React 19.1.0
- TypeScript (project config sá»­ dá»¥ng `strict: true`)
- @tanstack/react-query
- Radix UI / ShadCN (UI primitives)
- Tailwind CSS

> PhiÃªn báº£n chi tiáº¿t vÃ  script náº±m trong `package.json`.

---

## ğŸ“‚ Cáº¥u trÃºc chÃ­nh cá»§a repository (thÆ° má»¥c gá»‘c)

- `app/` â€” Next.js App Router (pages/route-based folders, layouts, server components)
  - ÄÃ¢y lÃ  nÆ¡i chá»©a cÃ¡c route chÃ­nh, bao gá»“m cÃ¡c route nhÃ³m trong `(routes)` hoáº·c `(auth)`, `page.tsx`, `layout.tsx`.
- `components/` â€” CÃ¡c component tá»•ng há»£p, composite vÃ  UI-level components
  - vÃ­ dá»¥: `components/composite/`, `components/ui/`, `components/mobile/`, `components/features/`
- `config/` â€” cáº¥u hÃ¬nh (vÃ­ dá»¥ cookie-config.ts)
- `context/` â€” providers vÃ  wrapper (vÃ­ dá»¥ `context/providers`)
- `hooks/` â€” custom hooks (business hooks, hooks dÃ¹ng React Query)
- `lib/` â€” biáº¿n, helper nhá», constants (vÃ­ dá»¥ `images-var.ts`, `strings.ts`)
- `services/` â€” API layer (`services/api/core.ts`, `services/api/*-service.ts`)
- `store/` â€” Zustand stores (vÃ­ dá»¥ `store/zustand/auth-store.ts`)
- `public/` â€” assets tÄ©nh
- `styles/` â€” global CSS / Tailwind
- `types/` â€” type definitions (vÃ­ dá»¥ `types/api-type.ts`)
- `utils/` â€” cÃ¡c util chung vÃ  hooks helper
- root files: `package.json`, `tsconfig.json`, `eslint.config.mjs`, `next.config.ts`, `CONVENTION.MD`


HeartSpace/
â”œâ”€â”€ app/ # Next.js App Router (routes, layouts, server components)
â”‚ â”œâ”€â”€ (auth)/... # auth-related routes
â”‚ â”œâ”€â”€ (dashboard)/â€¦
â”‚ â””â”€â”€ layout.tsx
â”œâ”€â”€ components/ # UI components (Atomic Design)
â”‚ â”œâ”€â”€ composite/
â”‚ â”œâ”€â”€ ui/
â”‚ â”œâ”€â”€ mobile/
â”‚ â””â”€â”€ features/
â”œâ”€â”€ config/ # config files (cookie-config.ts, env.ts, â€¦)
â”œâ”€â”€ context/ # Providers vÃ  wrappers
â”œâ”€â”€ hooks/ # Custom hooks (business + react-query)
â”œâ”€â”€ lib/ # Constants, helpers nhá» (images-var.ts, strings.ts)
â”œâ”€â”€ services/ # API service layer
â”‚ â””â”€â”€ api/
â”‚ â”œâ”€â”€ core.ts
â”‚ â””â”€â”€ auth-service.ts
â”œâ”€â”€ store/ # Zustand stores (auth-store.ts, â€¦)
â”œâ”€â”€ styles/ # Tailwind/global CSS
â”œâ”€â”€ types/ # Type definitions (api-type.ts, â€¦)
â”œâ”€â”€ utils/ # Helpers & utilities
â””â”€â”€ public/ # Static assets

---

## ğŸ“Œ Quy Æ°á»›c Ä‘áº·t tÃªn

- File: `kebab-case` (vÃ­ dá»¥ `login-form.tsx`, `auth-service.ts`, `auth-store.ts`)
- React component (exported function / default export): TÃªn component dÃ¹ng `PascalCase` (vÃ­ dá»¥ `function LoginForm(...) {}`) â€” nhÆ°ng file váº«n Ä‘á»ƒ `kebab-case`
- Hook: `use-` prefix + kebab-case filename (vÃ­ dá»¥ file `use-auth.ts`, export `useAuth`)
- Store: `kebab-case-store.ts` vÃ  export tÃªn Pascal/Camel tÆ°Æ¡ng á»©ng (vÃ­ dá»¥ `useAuthStore`)
- Variable / function: `camelCase`
- Type / Interface / Enum: `PascalCase`
- Constant values: `UPPER_SNAKE_CASE` (hoáº·c `camelCase` cho cÃ¡c constant export náº¿u cáº§n theo convention ná»™i bá»™)

LÆ°u Ã½: repository hiá»‡n sá»­ dá»¥ng alias `@/*` (Ä‘Æ°á»£c khai bÃ¡o trong `tsconfig.json`), import ná»™i bá»™ nÃªn dÃ¹ng `@/path/to/module`.

---

## âœ¨ Code style & tooling

- TypeScript Ä‘Æ°á»£c báº­t `strict` theo `tsconfig.json` â€” luÃ´n bÃ¡m cháº·t types, trÃ¡nh `any` trá»« khi cÃ³ lÃ½ do rÃµ rÃ ng.
- ESLint Ä‘Æ°á»£c cáº¥u hÃ¬nh dá»±a trÃªn `next/core-web-vitals` (xem `eslint.config.mjs`).
- Import order khuyáº¿n nghá»‹:

  1. React / next imports
  2. External libraries
  3. Aliased/internal imports (`@/...`)
  4. Styles / asset imports

- Components: function components (React.FC khÃ´ng báº¯t buá»™c). Prefer explicit return type for exported functions when it improves readability.
- API responses: luÃ´n type hoÃ¡ (`ApiResponse<T>` hoáº·c interface cá»¥ thá»ƒ). TrÃ¡nh tráº£ vá» `any` tá»« service layer.
- Styling: dÃ¹ng Tailwind utility classes; cho styles chung/variables Ä‘áº·t trong `styles/`.

Run & lint:

- dev: `npm run dev` (Next.js dev server)
- lint: `npm run lint` (cháº¡y eslint)

---

## ğŸ”— VÃ­ dá»¥ service layer (hiá»‡n Ä‘ang dÃ¹ng trong repo)

`services/api/auth-service.ts` (vÃ­ dá»¥)

```ts
import { ApiResponse } from "@/types/api-type";
import apiService from "./core";

export enum Roles {
  Admin = "Admin",
  User = "User",
}

export interface LoginCredentials {
  keyLogin: string;
  password: string;
  rememberMe?: boolean;
}

export interface LoginResponseData {
  accessToken: string;
  refreshToken: string;
  tokenType: string;
  accessTokenExpiry: Date;
  refreshTokenExpiry: Date;
}

export interface RegisterCredentials {
  fullName: string;
  email: string;
  phoneNumber: string;
  userName: string;
  password: string;
  confirmPassword: string;
}

export const AuthService = {
  login: async (credentials: LoginCredentials): Promise<ApiResponse<LoginResponseData>> => {
    const response = await apiService.post<ApiResponse<LoginResponseData>, LoginCredentials>(
      "api/auth/login",
      credentials
    );
    return response.data;
  },

  register: async (credentials: RegisterCredentials): Promise<ApiResponse<null>> => {
    const response = await apiService.post<ApiResponse<null>, RegisterCredentials>(
      "api/auth/register",
      credentials
    );
    return response.data;
  },
};
```

- React Query Implementation
1. Hook Structure

Hooks trong /hooks theo domain â†’ useAuth, useUserQuery, â€¦

Naming convention:

Query: use[Domain]Query

Mutation: use[Domain][Action]Mutation

Query keys: descriptive [domain, action, params]

DÃ¹ng enabled Ä‘á»ƒ conditionally fetch

Error handling Ä‘á»“ng bá»™ (toast + error state)

2. Query Management

Query keys array-based: ["user", id], ["auth", "me"]

Serialize filter object â†’ JSON.stringify

LuÃ´n invalidate/refetch khi mutation thÃ nh cÃ´ng

DÃ¹ng select Ä‘á»ƒ transform data

DÃ¹ng queryClient khi cáº§n quáº£n lÃ½ cache thá»§ cÃ´ng

3. Mutation Patterns

Há»— trá»£ optimistic updates khi phÃ¹ há»£p

Success/error â†’ consistent handling

LuÃ´n invalidate queries liÃªn quan sau mutation

Toast notification cho feedback

Preserve typing xuyÃªn suá»‘t flow

4. State Management Integration

Server state: React Query

Auth/local state: Zustand

Token â†’ lÆ°u trong store + cookie

Loading/error â†’ quáº£n lÃ½ trong hook

Logout â†’ clear cache, store, cookies

5. Performance Optimization

Cáº¥u hÃ¬nh staleTime, cacheTime há»£p lÃ½

refetchOnWindowFocus: false (trá»« khi cáº§n realtime)

Deduplicate query vá»›i key giá»‘ng nhau

Retry logic cho lá»—i network

Prefetch data critical khi vÃ o route




